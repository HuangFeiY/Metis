alert udp any any -> any 69 ( msg:"PROTOCOL-TFTP GET transfer mode overflow attempt"; flow:to_server; content:"|00 01|"; content:"|00|",distance 1; isdataat:100,relative; content:!"|00|",within 100; metadata:policy max-detect-ips drop; reference:bugtraq,13821; reference:cve,2005-1812; classtype:attempted-admin; sid:3817; rev:7; )
alert udp any any -> any 69 ( msg:"PROTOCOL-TFTP PUT transfer mode overflow attempt"; flow:to_server; content:"|00 02|"; content:"|00|",distance 1; isdataat:100,relative; content:!"|00|",within 100; metadata:policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,13821; reference:bugtraq,21301; reference:cve,2005-1812; reference:cve,2006-6183; classtype:attempted-admin; sid:3818; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:"PROTOCOL-TFTP UDP large packet use after free attempt"; flow:stateless; content:"|00 01|",depth 2; content:"blksize|00|"; byte_test:5,>=,1500,0,relative,string,dec; metadata:policy max-detect-ips drop; service:tftp; reference:cve,2013-4563; reference:cve,2018-8476; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8476; classtype:attempted-user; sid:32637; rev:4; )
