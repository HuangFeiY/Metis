alert tcp $EXTERNAL_NET any -> $HOME_NET 7597 ( msg:"MALWARE-BACKDOOR QAZ Worm Client Login access"; flow:to_server,established; content:"qazwsx.hsq"; metadata:ruleset community; classtype:misc-activity; sid:108; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 12345:12346 ( msg:"MALWARE-BACKDOOR netbus getinfo"; flow:to_server,established; content:"GetInfo|0D|"; metadata:ruleset community; classtype:trojan-activity; sid:110; rev:10; )
alert tcp $EXTERNAL_NET 1000:1300 -> $HOME_NET 146 ( msg:"MALWARE-BACKDOOR Infector 1.6 Client to Server Connection Request"; flow:to_server,established; content:"FC "; metadata:ruleset community; reference:nessus,11157; classtype:misc-activity; sid:121; rev:14; )
alert tcp $HOME_NET 31785 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR HackAttack 1.20 Connect"; flow:to_client,established; content:"host"; metadata:ruleset community; classtype:misc-activity; sid:141; rev:10; )
alert tcp $HOME_NET 30100:30102 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR NetSphere access"; flow:to_client,established; content:"NetSphere"; metadata:ruleset community; classtype:trojan-activity; sid:146; rev:13; )
alert tcp $HOME_NET 5401:5402 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR BackConstruction 2.1 Connection"; flow:to_client,established; content:"c|3A 5C|"; metadata:ruleset community; classtype:misc-activity; sid:152; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 666 ( msg:"MALWARE-BACKDOOR BackConstruction 2.1 Client FTP Open Request"; flow:to_server,established; content:"FTPON"; metadata:ruleset community; classtype:misc-activity; sid:157; rev:9; )
alert tcp $HOME_NET 666 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR BackConstruction 2.1 Server FTP Open Reply"; flow:to_client,established; content:"FTP Port open"; metadata:ruleset community; classtype:misc-activity; sid:158; rev:10; )
alert udp $EXTERNAL_NET 3344 -> $HOME_NET 3345 ( msg:"MALWARE-BACKDOOR Matrix 2.0 Client connect"; flow:to_server; content:"activate"; metadata:ruleset community; classtype:misc-activity; sid:161; rev:10; )
alert udp $EXTERNAL_NET 3345 -> $HOME_NET 3344 ( msg:"MALWARE-BACKDOOR Matrix 2.0 Server access"; flow:to_server; content:"logged in"; metadata:ruleset community; classtype:misc-activity; sid:162; rev:10; )
alert tcp $HOME_NET 5714 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR WinCrash 1.0 Server Active"; flow:stateless; flags:AS,12; content:"|B4 B4|"; metadata:ruleset community; classtype:misc-activity; sid:163; rev:14; )
alert udp $HOME_NET 2140 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR DeepThroat 3.1 Server Response"; flow:to_client; content:"Ahhhh My Mouth Is Open"; metadata:ruleset community; reference:nessus,10053; classtype:trojan-activity; sid:195; rev:15; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR w00w00 attempt"; flow:to_server,established; content:"w00w00"; metadata:ruleset community; classtype:attempted-admin; sid:209; rev:9; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR MISC r00t attempt"; flow:to_server,established; content:"r00t"; metadata:ruleset community; classtype:attempted-admin; sid:211; rev:7; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR MISC rewt attempt"; flow:to_server,established; content:"rewt"; metadata:ruleset community; classtype:attempted-admin; sid:212; rev:7; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR MISC Linux rootkit attempt"; flow:to_server,established; content:"wh00t!"; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1014; classtype:attempted-admin; sid:213; rev:9; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR MISC Linux rootkit attempt lrkr0x"; flow:to_server,established; content:"lrkr0x"; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1014; classtype:attempted-admin; sid:214; rev:9; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR MISC Linux rootkit satori attempt"; flow:to_server,established; content:"satori"; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1014; classtype:attempted-admin; sid:216; rev:12; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR MISC sm4ck attempt"; flow:to_server,established; content:"hax0r"; metadata:ruleset community; classtype:attempted-admin; sid:217; rev:7; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR MISC Solaris 2.5 attempt"; flow:to_server,established; content:"friday"; metadata:ruleset community; classtype:attempted-user; sid:218; rev:8; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR HidePak backdoor attempt"; flow:to_server,established; content:"StoogR"; metadata:ruleset community; classtype:misc-activity; sid:219; rev:10; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"MALWARE-BACKDOOR HideSource backdoor attempt"; flow:to_server,established; content:"wank"; metadata:ruleset community; classtype:misc-activity; sid:220; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR FsSniffer connection attempt"; flow:to_server,established; content:"RemoteNC Control Password|3A|"; metadata:ruleset community; reference:nessus,11854; classtype:trojan-activity; sid:2271; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 31337 ( msg:"MALWARE-BACKDOOR BackOrifice 2000 Inbound Traffic"; flow:to_server,established; content:"1j|D0 D9|"; metadata:ruleset community; classtype:trojan-activity; sid:3155; rev:7; )
alert tcp $EXTERNAL_NET 4225 -> $HOME_NET any ( msg:"MALWARE-BACKDOOR silent spy 2.10 command response port 4225"; flow:to_client,established; content:"+---|7C|"; content:"|7C|---+",distance 0; pcre:"/\x2B\x2D{3}\x7C[^\r\n]*\x7C\x2D{3}\x2B/ims"; reference:url,www.spywareguide.com/product_show.php?id=1530; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453073048; classtype:trojan-activity; sid:6021; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8799 ( msg:"MALWARE-BACKDOOR fun factory runtime detection - connect"; flow:to_server,established; content:"|AD 86 01 00 08 00 00 00|"; content:"1^Merlin",distance 0,nocase; pcre:"/^\xad\x86\x01\x00\x08\x00\x00\x001\x5EMerlin/ims"; flowbits:set,FunFactory_conn; flowbits:noalert; reference:url,www.2-spyware.com/remove-funfactory-trojan.html; reference:url,www.spywareguide.com/product_show.php?id=1649; classtype:trojan-activity; sid:6047; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8799 ( msg:"MALWARE-BACKDOOR fun factory runtime detection - upload"; flow:to_server,established; content:"|AB 86 01 00 12 00 00 00|"; flowbits:set,FunFactory_upload; flowbits:noalert; reference:url,www.2-spyware.com/remove-funfactory-trojan.html; reference:url,www.spywareguide.com/product_show.php?id=1649; classtype:trojan-activity; sid:6049; rev:5; )
alert tcp $HOME_NET 8799 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR fun factory runtime detection - upload"; flow:to_client,established; flowbits:isset,FunFactory_upload; content:"100011"; reference:url,www.2-spyware.com/remove-funfactory-trojan.html; reference:url,www.spywareguide.com/product_show.php?id=1649; classtype:trojan-activity; sid:6050; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8799 ( msg:"MALWARE-BACKDOOR fun factory runtime detection - set volume"; flow:to_server,established; content:"|B0 86 01 00 01 00 00 00|0"; flowbits:set,FunFactory_volume; flowbits:noalert; reference:url,www.2-spyware.com/remove-funfactory-trojan.html; reference:url,www.spywareguide.com/product_show.php?id=1649; classtype:trojan-activity; sid:6051; rev:5; )
alert tcp $HOME_NET 8799 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR fun factory runtime detection - set volume"; flow:to_client,established; flowbits:isset,FunFactory_volume; content:"100016"; reference:url,www.2-spyware.com/remove-funfactory-trojan.html; reference:url,www.spywareguide.com/product_show.php?id=1649; classtype:trojan-activity; sid:6052; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8799 ( msg:"MALWARE-BACKDOOR fun factory runtime detection - do script remotely"; flow:to_server,established; content:"|AE 86 01 00|"; flowbits:set,FunFactory_doscript; flowbits:noalert; reference:url,www.2-spyware.com/remove-funfactory-trojan.html; reference:url,www.spywareguide.com/product_show.php?id=1649; classtype:trojan-activity; sid:6053; rev:5; )
alert tcp $HOME_NET 8799 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR fun factory runtime detection - do script remotely"; flow:to_client,established; flowbits:isset,FunFactory_doscript; content:"100014"; reference:url,www.2-spyware.com/remove-funfactory-trojan.html; reference:url,www.spywareguide.com/product_show.php?id=1649; classtype:trojan-activity; sid:6054; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR bifrose 1.1 runtime detection"; flow:to_server,established; content:"|00 00 00 91|I|16 1B|e|1C|"; flowbits:set,bifrose.rev_conn.1; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=1464; classtype:trojan-activity; sid:6055; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR bifrose 1.1 runtime detection"; flow:to_client,established; flowbits:isset,bifrose.rev_conn.1; content:"|02 00 00 00|4x"; flowbits:set,bifrose.rev_conn.2; flowbits:unset,bifrose.rev_conn.1; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=1464; classtype:trojan-activity; sid:6056; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR bifrose 1.1 runtime detection"; flow:to_server,established; flowbits:isset,bifrose.rev_conn.2; content:"|02 00 00 00 90|x"; reference:url,www.spywareguide.com/product_show.php?id=1464; classtype:trojan-activity; sid:6057; rev:6; )
alert tcp $HOME_NET 6969 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR cookie monster 0.24 runtime detection - get version info"; flow:to_client,established; flowbits:isset,CookieMonster_GetVersionInfo; content:"Cookie"; content:"Monster",distance 0; content:"server",distance 0; content:"engine",distance 0; pcre:"/Cookie\s+Monster\s+server\s+engine/ims"; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453084262; classtype:trojan-activity; sid:6172; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR net demon runtime detection - initial connection - password send"; flow:to_server,established; flowbits:isset,NetDemon_Init1; content:"PWD "; pcre:"/^PWD\s+[^\r\n]*\n/ms"; flowbits:set,NetDemon_Init2; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=4029; classtype:trojan-activity; sid:6310; rev:5; )
alert udp $EXTERNAL_NET 8012 -> $HOME_NET any ( msg:"MALWARE-BACKDOOR ptakks2.1 runtime detection - keepalive acknowledgement"; flow:to_client; flowbits:isset,PtakkS_Keepalive; content:",jRj,"; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453079909; classtype:trojan-activity; sid:6321; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 11000 ( msg:"MALWARE-BACKDOOR commando runtime detection - chat client-to-server"; flow:to_server,established; content:"Cliente |3A|"; flowbits:set,Commando; flowbits:noalert; reference:url,www.megasecurity.org/trojans/c/comando/Comando.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453068368; classtype:trojan-activity; sid:6329; rev:4; )
alert tcp $EXTERNAL_NET 11000 -> $HOME_NET any ( msg:"MALWARE-BACKDOOR commando runtime detection - chat server-to-client"; flow:to_client,established; flowbits:isset,Commando; content:"Servidor |3A|"; reference:url,www.megasecurity.org/trojans/c/comando/Comando.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453068368; classtype:trojan-activity; sid:6330; rev:6; )
alert tcp $HOME_NET 12624 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR buttman v0.9p runtime detection - remote control"; flow:to_client,established; flowbits:isset,buttman.1; content:"|23|+|0D 0A|"; reference:url,www.spywareguide.com/product_show.php?id=684; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453089720; classtype:trojan-activity; sid:6336; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1480 ( msg:"MALWARE-BACKDOOR remote hack 1.5 runtime detection - execute file"; flow:to_server,established; content:"executafile|7C|"; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy security-ips drop; reference:url,www.spywareguide.com/product_show.php?id=1523; classtype:trojan-activity; sid:7097; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1480 ( msg:"MALWARE-BACKDOOR remote hack 1.5 runtime detection - get password"; flow:to_server,established; content:"catasenha|7C|"; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy security-ips drop; reference:url,www.spywareguide.com/product_show.php?id=1523; classtype:trojan-activity; sid:7098; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1480 ( msg:"MALWARE-BACKDOOR remote hack 1.5 runtime detection - start keylogger"; flow:to_server,established; content:"kstart|7C|"; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy security-ips drop; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.spywareguide.com/product_show.php?id=1523; classtype:trojan-activity; sid:7099; rev:6; )
alert tcp $EXTERNAL_NET 5024 -> $HOME_NET any ( msg:"MALWARE-BACKDOOR illusion runtime detection - get remote info server-to-client"; flow:to_client,established; flowbits:isset,Illusion_Info; content:"023"; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453077268; classtype:trojan-activity; sid:7686; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 5024 ( msg:"MALWARE-BACKDOOR illusion runtime detection - file browser client-to-server"; flow:to_server,established; content:"[LOAD DRIVE DATA]"; flowbits:set,Illusion_File; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453077268; classtype:trojan-activity; sid:7687; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 9999 ( msg:"MALWARE-BACKDOOR evade runtime detection - file manager - flowbit set"; flow:to_server,established; content:"DRIVECHANGE +"; flowbits:set,Evade_File_Manager1; flowbits:noalert; reference:url,www.megasecurity.org/trojans/e/evade/Evade1.1b.html; classtype:trojan-activity; sid:7690; rev:6; )
alert tcp $EXTERNAL_NET 9999 -> $HOME_NET any ( msg:"MALWARE-BACKDOOR evade runtime detection - file manager"; flow:to_client,established; flowbits:isset,Evade_File_Manager1; content:"FRESH +"; reference:url,www.megasecurity.org/trojans/e/evade/Evade1.1b.html; classtype:trojan-activity; sid:7691; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3100 ( msg:"MALWARE-BACKDOOR brain wiper runtime detection - launch application - flowbit set"; flow:to_server,established; content:"APP"; flowbits:set,BrAin_Wiper_LaunchApplication; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=903; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453068367; classtype:trojan-activity; sid:7698; rev:4; )
alert tcp $HOME_NET 445 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR omniquad instant remote control runtime detection - initial connection"; flow:to_client,established; flowbits:isset,Omniquad_IRC_InitConnection; content:"|00 00 00|h|FF|SMB%|00 00 00|"; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453080053; classtype:trojan-activity; sid:7706; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR buschtrommel 1.22 runtime detection - initial connection"; flow:to_client,established; flowbits:isset,BuschTrommel_InitConnection2; content:"*VER1.22|28|REI|29|"; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=20757; classtype:trojan-activity; sid:7752; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR incommand 1.7 runtime detection - init connection"; flow:to_client,established; flowbits:isset,InCommand_17_InitConnection; content:"PASSOK"; reference:url,www.spywareguide.com/product_show.php?id=1637; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=44730; classtype:trojan-activity; sid:7796; rev:7; )
alert tcp $HOME_NET 6666 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR fatal wound 1.0 runtime detection - upload"; flow:to_client,established; flowbits:isset,fatalwound_upload; content:"Send File -~-"; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453077104; classtype:trojan-activity; sid:7809; rev:6; )
alert tcp $HOME_NET 23 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR abacab runtime detection - telnet initial"; flow:to_client,established; content:" |0D 0A|Vous etes connecte a|3A 0D 0A 0D 0A 00|"; flowbits:set,Abacab; flowbits:noalert; reference:url,megasecurity.org/trojans/a/abacab/Abacab0.9beta.html; classtype:trojan-activity; sid:7811; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR nirvana 2.0 runtime detection - explore c drive"; flow:to_server,established; isdataat:!19; content:"|AC|kC|3A 5C|"; metadata:policy max-detect-ips drop; reference:url,www.megasecurity.org/trojans/n/nirvana/Nirvana2.0.html; classtype:trojan-activity; sid:10442; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR only 1 rat runtime detection - control command"; flow:to_server,established; flowbits:isset,Only1RAT_Control; content:"|7C FF 00 FF 00 FF 00 FF 00 FF 00 FF 0D 0A|"; metadata:policy max-detect-ips drop; reference:url,research.sunbelt-software.com/threatdisplay.aspx?name=Only%201%20RAT&threatid=40632; classtype:trojan-activity; sid:10451; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR blue eye 1.0b runtime detection - init connection"; flow:to_client,established; flowbits:isset,BlueEye1.0b_detection; isdataat:2; isdataat:!3; content:"SUC"; metadata:policy max-detect-ips drop; reference:url,secunia.com/virus_information/11032/blueye-a/; reference:url,www.spywareguide.com/spydet_816_blue_eye_1_0b.html; classtype:trojan-activity; sid:12147; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR theef 2.10 runtime detection - ftp"; flow:to_client,established; content:"Theef2"; content:"FTP",distance 0; content:"Server",distance 0; pcre:"/Theef2\s+FTP\s+Server\x3A/"; flowbits:set,Theef210_TheefFTP; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12237; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR theef 2.10 runtime detection - ftp"; flow:to_server,established; flowbits:isset,Theef210_TheefFTP; content:"Theef2.10_"; metadata:policy max-detect-ips drop; reference:url,www.spywareguide.com/product_show.php?id=859; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2002-071209-4425-99; classtype:trojan-activity; sid:12238; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Rebhip.A runtime detection"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|5F 78 5F 58 5F 42 4C 4F 43 4B 4D 4F 55 53 45 5F 58 5F 78 5F|",fast_pattern,nocase; content:"|5F 78 5F 58 5F 55 50 44 41 54 45 5F 58 5F 78 5F|"; content:"|5F 78 5F 58 5F 50 41 53 53 57 4F 52 44 4C 49 53 54 5F 58 5F 78 5F|",distance 0; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; reference:url,www.virustotal.com/#/file/d3ef727eb86c4bdde8e64800e600d3f4/detection; classtype:trojan-activity; sid:21967; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Win.Backdoor.ZZSlash runtime detection"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"GH0STC"; content:"GH0STC",within 200; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; reference:url,www.virustotal.com/#/file/11906a9c342f840ffa01e1aeb411cf1a/detection; classtype:trojan-activity; sid:21973; rev:8; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Win.Backdoor.Georbot file download"; flow:to_client,established; file_data; flowbits:isset,file.exe; content:"|55 89 E5 83 EC 1C 80 3D F7 B7 40 00 00 74 0B 68 95 0E 41 00|",fast_pattern,nocase; content:"|FF 15 EC 90 40 00 FF 75 08 FF 15 34 91 40 00 89 45 F4 83 C0|"; content:"|3C 8B 00 03 45 F4 89 45 F0 8B 45 F0 8B 40 78 03 45 F4 8B 58|",within 20; content:"|20 03 5D F4 89 5D E4 8B 40 18 89 45 EC 8B 45 F0 8B 40 78 03|",within 20; content:"|45 F4 8B 58 1C 03 5D F4 89 5D E8 8B 45 F0 8B 40 78 03 45 F4|",within 20; content:"|8B 58 24 03 5D F4 89 5D F8 6A 00 C1 C9 04 59 C6 05 72 9C 40|",within 20; content:"|00 00|",within 2; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data,http,imap,pop3; reference:url,www.virustotal.com/file/d7551c07bce29757996b35bdd3bfcecdb3f10aa6807b22a95bea41f6c92e4f1a/analysis/; classtype:trojan-activity; sid:23483; rev:8; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Trojan.FakeAV.FakeAlert runtime detection"; flow:to_server,established; http_uri; content:"?0="; content:"&1=",distance 0; content:"&2=1",distance 0; content:"&3=",distance 0; pcre:"/0=\d+&1=\d&2=1&3=\d+&4=i&5=\d+&6=\d+&7=\d+&8=\S{0,16}&9=\d+&10=\S+&11=1111&12=\S{10}&14=\d/i"; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/file/19eb78edb2aa13959a5a621744168bdb8e29b2ba4b7c91efe0f7e34060eabc4e/analysis/; classtype:trojan-activity; sid:24377; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Win.Trojan.Ransomlock runtime detection"; flow:to_server,established; http_uri; content:"?id="; content:"&cmd=img",within 8,distance 20; pcre:"/\?id=[A-Z0-9]{20}&cmd=img/"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/file/f9aafe67d4afe9526c1033fbfc861484105be3f09bdef92d911311f96ed05e4b/analysis; classtype:trojan-activity; sid:24530; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR DarkSeoul related wiper"; flow:to_client,established; content:"JO840112-CRAS8468-11150923-PCI8273V",fast_pattern,nocase; file_data; content:"|5F 0F 94 C0 5E C9 C3 53 56 8B 74 24 0C 33 DB 57 39 1E 7E 19 8D BE 78 01 00 00 FF 37 56 FF 96 A0|"; content:"taskkill /F /IM pasvc.exe"; content:"GIt%"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; reference:url,www.virustotal.com/en/file/510f83af3c41f9892040a8a80b4f3a4736eebee2ec4a7d4bfee63dbe44d7ecff/analysis/; classtype:trojan-activity; sid:26326; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Windows vernot download"; flow:to_client,established; content:"|2F|res|2F 7C|1|7C|2|7C|3|7C|4|7C|5|7C|5|7C|5|7C|6|7C|5|7C|7|7C|8|7C|9|7C|10|7C|1|7C|5|7C|11|7C|12|7C|700|7C|",fast_pattern,nocase; file_data; content:"|7C 5B|Z/1413617015|7C|com.evernote.edam.type.NoteAttributes/3819593128|7C 5B|B/3308590456|7C|"; content:"&targetUrl=%2FHome.action&targetUrl=%2FHome.action&login=%E7%99%BB%E5%BD%95&_sourcePage="; content:"$_$Today is a very important day for me.$"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; reference:url,www.virustotal.com/en/file/e21921abd435f1523f41a040b8423f123487c1d9e8e5443ee219589ad8235e63/analysis/; classtype:trojan-activity; sid:26328; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Unix.Backdoor.Cdorked backdoor command attempt"; flow:to_server,established; content:"SECID=",fast_pattern,nocase; http_cookie; content:"SECID=",depth 6; http_method; content:"POST"; http_raw_header; pcre:"/^Cookie\x3a\s?SECID=[^\x3b]+?$/m"; http_uri; pcre:"/\?[a-f0-9]{4}$/im"; metadata:impact_flag red,policy max-detect-ips drop; service:http; reference:url,blog.sucuri.net/2013/04/apache-binary-backdoors-on-cpanel-based-servers.html; reference:url,virustotal.com/en/file/7b3cd8c1bd0249df458084f28d91648ad14e1baf455fdd53b174481d540070c6/analysis/; classtype:trojan-activity; sid:26529; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 2533 ( msg:"MALWARE-BACKDOOR Win.Trojan.Shatekrat variant initial outbound connection"; flow:to_server,established; content:"|2E|Data|03 00 00 00 04|data|05|image|05|bytes",fast_pattern,nocase; content:"|00 00 00|"; content:"102622021F200324",within 16,distance 1; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/en/file/0c5a5a85ced8c201508d45613330e3909ed99cef90ae15b3695d27928f74407c/analysis/; classtype:trojan-activity; sid:29094; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Win.Trojan.Dremseko outbound username enumeration"; flow:to_server,established; http_uri; content:"/dbg.php?e=",depth 11,fast_pattern; http_raw_uri; content:"|5C|"; content:"%20",within 33; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,virustotal.com/en/file/44024e287dd998921c3901aa4320a59c3a7a50a2ba750d7383ed3b010de165e3/analysis/; classtype:trojan-activity; sid:29874; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR ReGeorg proxy read attempt"; flow:to_server,established; content:"cmd=read"; http_header; content:"X-CMD|3A| READ|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/en/file/b97136e3235c1bc9f2005d3253fbc3af5900f8222740cfd85ef5d449cf4ac251/analysis/; classtype:misc-activity; sid:38327; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR ReGeorg socks proxy connection attempt"; flow:to_server,established; http_uri; content:"cmd=connect"; content:"target="; content:"port="; http_header; content:"X-CMD|3A| CONNECT|0D 0A|",fast_pattern,nocase; content:"X-TARGET|3A| "; content:"X-PORT|3A| "; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/en/file/b97136e3235c1bc9f2005d3253fbc3af5900f8222740cfd85ef5d449cf4ac251/analysis/; classtype:misc-activity; sid:38328; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR JSP webshell backdoor file management attempt"; flow:to_server,established; content:"FolderPath=",fast_pattern,nocase; content:"FolderPath=",nocase; content:"Action=",nocase; content:"Filename=",nocase; content:".jsp"; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:46291; rev:1; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Rebhip variant runtime detection"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"x_X_BLOCKMOUSE",fast_pattern,nocase; content:"PASS"; content:"UPDAT"; metadata:policy max-detect-ips drop; service:http; reference:url,www.virustotal.com/#/file/15f8396754898348d0df09c85a304e2359c9102e87e7fed270e10b3814a82a7d/detection; classtype:trojan-activity; sid:48146; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR JSP Web shell transfer attempt"; flow:to_client,established; file_data; content:"|22|yay|22|.equals(request.getParameter(|22|pwd|22|",fast_pattern,nocase; content:".exec(request.getParameter(|22|cmd|22|"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; reference:url,virustotal.com/en/file/09bac8d96033a5963aa763c719cfb03eb2c7cba9c549d9ba7621753a929155e0/analysis/; classtype:attempted-user; sid:50476; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Win.Backdoor.Agent webshell inbound request attempt"; flow:to_server,established; http_header; content:"Response.Write(|22|UAshell|22|)|3B 0D 0A|",fast_pattern,nocase; http_uri; content:"/ua.aspx"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:cve,2019-0604; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0604; classtype:trojan-activity; sid:51368; rev:2; )
alert tcp $EXTERNAL_NET 49152:65535 -> $HOME_NET 49152:65535 ( msg:"MALWARE-BACKDOOR TLS certificate securing LocalXpose reverse proxy backdoor"; flow:to_client,established; content:"localxpose.io"; content:"*.loclx.io",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ssl; reference:url,virustotal.com/#/file/227c127b4614dfb4631b44f40c8f98c6549c7238bc3b70af74e5a7b9170cbe85/detection; classtype:trojan-activity; sid:51535; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR MultiOS.Malware.GORAT malware download attempt"; flow:to_client,established; file_data; content:"aqlKZ7wjzg0iKM00E1WB/jq9_RA46w91EKl9A02Dv/nbNdZiLsB1ci8Ph0fb64/9Ks1YxAE86iz9A0dUiDl"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp-data,http,imap,pop3; reference:url,fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56594; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Cobalt Strike beacon connection attempt"; flow:to_server,established; http_header; content:"client-=",fast_pattern,nocase; content:"Accept-Encoding|3A| gzip, deflate, br"; content:"|5C 3B|auth=1|7D|"; http_uri; pcre:"/^\/v1\/(queue|profile|docs\/wsdl|pull)/i"; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56614; rev:1; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"Request"; content:"eval(",within 300,fast_pattern; pcre:"/Request(?:\x2eForm)?[\x28\x5b][\x22\x27]\w+[\x22\x27][\x29\x5d]\x3b\s*var\s+\w+\s*=\s*(?:\w+[\x28\x5b]\d+[\x29\x5d](?:\s*\x2b\s*)?){6}\x3b\s*eval\x28/i"; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57314; rev:1; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"runat=|22|server|22|",fast_pattern,nocase; content:"Convert.ToBase64String"; content:"System.Security.Cryptography",within 75; content:"HttpContext.Current.Request",within 100; content:"System.Diagnostics.Process"; content:".Start",within 250; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57319; rev:1; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"System.Text.Encoding.Default.GetString(Convert.FromBase64String(StrTr(Request.Headers.Get",fast_pattern,nocase; content:"System.Net.Sockets"; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57320; rev:1; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Asp.Trojan.Hafnium web shell upload attempt"; flow:to_server,established; file_data; content:"runat=|22|server|22|",fast_pattern,nocase; content:"Request.Headers.Get"; content:".Split(",within 100; content:"new IPEndPoint("; content:"new Socket(",within 250; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:57321; rev:1; )
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE webshell variant access"; flow:to_client,established; file_data; content:"Results of |27|"; content:"|27| execution:|0A 0A|",within 260; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57462; rev:1; )
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE webshell variant access"; flow:to_client,established; file_data; content:"<form action=|22 22| method=|22|GET|22|>"; content:"<input type=|22|text|22| name=|22|cmd|22|",distance 0; content:"<input type=|22|text|22| name=|22|serverid|22|",distance 0,fast_pattern; content:"<input type=|22|submit|22| value=|22|Run|22|>",distance 0; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html; classtype:trojan-activity; sid:57463; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"MALWARE-BACKDOOR Jsp.Webshell.TinyUploader upload attempt"; flow:to_server,established; content:"java.io.FileOutputStream",fast_pattern,nocase; content:"<%"; content:"request",within 100; content:"write"; content:"getParameter",within 100; isdataat:!600; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; gid:1; sid:59927; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Jsp.Webshell.Chopper webshell download attempt"; flow:to_client,established; file_data; content:"DriverManager.getConnection"; content:"ServletOutputStream"; content:"ResultSetMetaData"; content:"request.getParameter"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; gid:1; sid:59928; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Jsp.Webshell.Noop download attempt"; flow:to_client,established; file_data; content:"java.util.*"; content:"java.io.FileOutputStream",distance 0; content:"request.getParameter(|22|name|22|)",within 200,fast_pattern; content:"request.getParameter(|22|contentString|22|)"; isdataat:!300,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:cve,2022-26134; reference:url,community.atlassian.com/t5/Confluence-discussions/CVE-2022-26134-Critical-severity-unauthenticated-remote-code/td-p/20456533; classtype:trojan-activity; gid:1; sid:59930; rev:2; )
alert file ( msg:"MALWARE-BACKDOOR Win.Backdoor.Chollima file download attempt"; file_data; flowbits:isset,file.exe; content:"3jB(2bsG#@c7",fast_pattern,nocase; content:"msvcr100.dll"; content:"C:|5C|windows|5C|system32|5C|winscard.dll.",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; gid:1; sid:300509; rev:1; )
